#!/usr/bin/env bash

# Open a CLI script in vim
# Mnemonic: (vi)m (w)hich
viw() {
  $EDITOR "$(which "$1")"
}

# Create a new directory and enter it
mcd() {
  mkdir -p "$@" && cd "$_" || return
}

# `o` with no arguments opens the current directory, otherwise opens the given
# location.
o() {
  if [ $# -eq 0 ]; then
    open .
  else
    open "$@"
  fi
}

# nnn - Terminal file manager
n() {
  # Purpose: Avoid opening
  # Block nesting of nnn in subshells
  if [ -n "$NNNLVL" ] && [ "${NNNLVL:-0}" -ge 1 ]; then
      echo "nnn is already running"
      return
  fi

  # The default behaviour is to cd on quit (nnn checks if NNN_TMPFILE is set)
  # To cd on quit only on ^G, remove the "export" as in:
  #
  #     export NNN_TMPFILE="${XDG_CONFIG_HOME:-$HOME/.config}/nnn/.lastd"
  #     ^----^
  #
  # NOTE: NNN_TMPFILE is fixed, should not be modified
  local NNN_TMPFILE="${XDG_CONFIG_HOME:-$HOME/.config}/nnn/.lastd"

  nnn "$@"

  if [ -f "$NNN_TMPFILE" ]; then
    . "$NNN_TMPFILE"
    rm -f "$NNN_TMPFILE" > /dev/null
  fi
}
