# --------------------------------------------------------------
# Plugins
# --------------------------------------------------------------

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'
set -g @plugin 'tmux-plugins/tmux-resurrect'


# --------------------------------------------------------------
# Key-bindings
# --------------------------------------------------------------
# NOTE:
# bind -r ...: This key may repeat (see repeat-time option)
# bind -n ...: binds the key in the root table
# bind    ...: binds the key in the prefix table
#
# If a key is bind in the root table, you don't have to press the prefix key before
# pressing the actual key. Be careful!

# Remap prefix from C-b to C-a
# IDEAS:
# - Use C-s?
# - Switch <CTRL> with <ESC> (formarly <CAPSLOCK>)
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# r to reload to config file
unbind r
bind r source-file ~/.tmux.conf \; display-message "Reloaded ~/.tmux.conf"

# sensible splits for panes
unbind '"'
unbind %
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Move between panes with vi keys
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Easy resizing of panes
bind -r C-j resize-pane -D 5
bind -r C-k resize-pane -U 5
bind -r C-h resize-pane -L 5
bind -r C-l resize-pane -R 5

# Easier and faster switching between next/prev window
bind C-p previous-window
bind C-n next-window


# --------------------------------------------------------------
# Options
# --------------------------------------------------------------

# Use tmux-256color if available
# https://gist.github.com/nicm/ea9cf3c93f22e0246ec858122d9abea1
# https://github.com/tmux/tmux/issues/2262
if-shell 'infocmp tmux-256color' \
    'set -g default-terminal "tmux-256color"' \
    'set -g default-terminal "screen-256color"'
set -ga terminal-overrides ",*256col*:Tc"

# Set mouse mode on
set -g mouse on

# Renumber windows on close
set -g renumber-windows on

# Use multiple commands without sending the prefix-key within 1 second
# (default is 500 ms).
set -g repeat-time 1000

# Increase scrollback buffer size
set -g history-limit 50000

# tmux messages are displayed for 4 seconds
set -g display-time 4000

# Display pane numbers for 4 seconds
set -g display-panes-time 4000

# Make tmux play nicely with vim
set -g focus-events on

# Start window numbers at 1 to match keyboard order with tmux order
set -g base-index 1

# Start pane numbers at 1 to match keyboard order with tmux order
setw -g pane-base-index 1

# Address vim mode switching delay
# Ref: http://superuser.com/a/252717/65504
set -sg escape-time 0

# Turn off automatic renaming for the window to reduce CPU load
setw -g automatic-rename off

# --------------------------------------------------------------
# Status bar
# --------------------------------------------------------------

# Colour Reference from custom_monokai_tasty theme
# NOTE: Update this if the theme file changes
# --------------------------------------------------------------
# yellow ..............	{ "cterm": 228, "gui": "#E7DC6D" }
# purple .............. { "cterm": 141, "gui": "#AC7CFF" }
# light_green .........	{ "cterm": 148, "gui": "#A4E400" }
# light_blue ..........	{ "cterm": 81,  "gui": "#62D8F1" }
# magenta .............	{ "cterm": 197, "gui": "#FC1A70" }
# orange ..............	{ "cterm": 208, "gui": "#FF9700" }
#
# white ...............	{ "cterm": 255, "gui": "#ffffff" }
# light_grey ..........	{ "cterm": 250, "gui": "#bcbcbc" }
# grey ................	{ "cterm": 245, "gui": "#8a8a8a" }
# dark_grey ...........	{ "cterm": 59,  "gui": "#5f5f5f" }
# darkest_grey ........	{ "cterm": 238, "gui": "#444444" }
# light_charcoal ......	{ "cterm": 236, "gui": "#303030" }
# charcoal ............	{ "cterm": 235, "gui": "#262626" }


# Options
# ---------------
# - Show/hide status line or specify its size
# - Update the status line every interval seconds
# - Position of the window list component (left, centre, right)
# - Position of the status bar (top, bottom)
# - Default statusbar color

set -g status on
set -g status-interval 5
set -g status-justify "left"
set -g status-position "bottom"
set -g status-style "fg=colour255,bg=colour236"
set -g status-right-length 100
set -g status-left-length 100


# Message
# ----------------
# - Writing commands bar
# - Message info

set -g message-command-style "fg=colour235,bg=colour148"
set -g message-style "fg=colour235,bg=colour148"


# Clock
# ----------------
# - Clock mode colour

set -g clock-mode-colour "colour81"


# Pane
# ----------------
# - Border style for panes aside from the active pane
# - Border style for the currently active pane
# - Colour for display-panes command to show inactive pane
# - Colour for display-panes command to show active pane

set -g pane-border-style "fg=colour240"
set -g pane-active-border-style "fg=colour148"
set -g display-panes-colour "colour245"
set -g display-panes-active-colour "colour148"


# Character pair replaced with
# -----------------------------
# #(shell-command) .... First line of the command's output
# #[attributes] ....... Colour or attribute change
# #H .................. Hostname of local host
# #h .................. Hostname of local host without the domain name
# #F .................. Current window flag
# #I .................. Current window index
# #P .................. Current pane index
# #S .................. Session name
# #T .................. Current window title
# #W .................. Current window name
# ## .................. A literal '#'

# Window
# ----------------

set -g window-status-format "\
#[fg=colour236,bg=colour238] \
#[fg=colour255,bg=colour238]#I  #W \
#[fg=colour238,bg=colour236]"

set -g window-status-current-format "\
#[fg=colour236,bg=colour148] \
#[fg=colour235,bg=colour148]#I  #W \
#[fg=colour148,bg=colour236]"

set -g window-status-separator ""


# Status
# ----------------

set -g status-left "\
#[fg=colour235,bg=colour208,bold] #S \
#[fg=colour208,bg=colour236]"

set -g status-right "\
#{prefix_highlight}\
#(~/dotfiles/tmux/scripts/music.sh)\
#[fg=colour148,bg=colour236]\
#[fg=colour235,bg=colour148] %a %d %b  %H:%M  #(~/dotfiles/tmux/scripts/battery.sh) \
#[fg=colour236,bg=colour148]\
#[fg=colour208,bg=colour236]\
#[fg=colour235,bg=colour208,none] #h "


# Prefix highlight plugin
# -----------------------

set -g @prefix_highlight_fg 'colour235' # default is 'colour231'
set -g @prefix_highlight_bg 'colour81'  # default is 'colour04'
set -g @prefix_highlight_output_prefix "#[fg=colour81]#[bg=colour236]#[fg=colour236]#[bg=colour81]"
set -g @prefix_highlight_output_suffix ""


# --------------------------------------------------------------
# Preloading
# --------------------------------------------------------------

# Initialize TMUX plugin manager
# (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
